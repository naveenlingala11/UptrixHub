<!-- ğŸ BUG HUNTER ANALYTICS -->

<h2>ğŸ Bug Hunter â€“ Most Wrong Bug Categories</h2>

<table class="analytics-table">
  <thead>
    <tr>
      <th>Bug Category</th>
      <th>Total Attempts</th>
      <th>Wrong Attempts</th>
      <th>Wrong %</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let a of analytics">
      <td>{{ a.bugCategory }}</td>
      <td>{{ a.totalAttempts }}</td>
      <td>{{ a.wrongAttempts }}</td>
      <td>
        <span [class.danger]="a.wrongPercentage > 50">
          {{ a.wrongPercentage | number:'1.0-1' }}%
        </span>
      </td>
    </tr>
  </tbody>
</table>

<h2>ğŸ”¥ Bug Hunter â€“ Question Accuracy Heatmap</h2>

<table class="heatmap">
  <thead>
    <tr>
      <th>Question</th>
      <th>Bug Category</th>
      <th>Attempts</th>
      <th>Correct</th>
      <th>Accuracy</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let q of heatmap" [class]="color(q.accuracy)">
      <td>{{ q.title }}</td>
      <td>{{ q.bugCategory }}</td>
      <td>{{ q.totalAttempts }}</td>
      <td>{{ q.correctAttempts }}</td>
      <td>{{ q.accuracy | number:'1.0-1' }}%</td>
    </tr>
  </tbody>
</table>

<!-- ğŸ“Š DAILY CHALLENGE ANALYTICS -->

<section class="analytics">

  <h2>ğŸ“Š Daily Challenge Analytics</h2>

  <div class="kpi-grid">
    <div class="kpi">
      <span>Total Submissions</span>
      <strong>{{ stats?.totalSubmissions }}</strong>
    </div>

    <div class="kpi success">
      <span>Success Rate</span>
      <strong>{{ stats?.successRate }}%</strong>
    </div>

    <div class="kpi xp">
      <span>Avg XP</span>
      <strong>{{ stats?.averageXp }}</strong>
    </div>
  </div>

  <div class="charts">
    <div class="chart-card">
      <h4>ğŸ“ˆ Submissions Trend</h4>
      <canvas #trendChart></canvas>
    </div>

    <div class="chart-card">
      <h4>ğŸ¯ Success vs Failure</h4>
      <canvas #successChart></canvas>
    </div>
  </div>

  <!-- DATE FILTER -->
  <div class="filter-bar">
    <div>
      <label>From</label>
      <input type="date" [(ngModel)]="fromDate">
    </div>

    <div>
      <label>To</label>
      <input type="date" [(ngModel)]="toDate">
    </div>

    <button (click)="applyFilter()">Apply</button>

    <div class="export-actions">
      <button class="btn outline" (click)="download('csv')">
        â¬‡ Export CSV
      </button>

      <button class="btn primary" (click)="download('excel')">
        â¬‡ Export Excel
      </button>
    </div>

  </div>

</section>