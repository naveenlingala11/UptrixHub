<!-- ================= NAVBAR ================= -->
<nav class="navbar">
  <div class="container nav-wrapper">

    <!-- ================= LEFT : BRAND ================= -->
    <div class="d-flex align-items-center gap-3">

      <div class="brand-wrapper">
        <img src="assets/logo.png" alt="Uptrix Hub Logo" class="brand-logo" />

        <div class="brand-text">
          <a class="brand" routerLink="/">Uptrix Hub</a>
          <span class="brand-tagline">Compile Your Success</span>
        </div>
      </div>

      <!-- MOBILE TOGGLE -->
      <button class="hamburger" (click)="toggleMobile()">‚ò∞</button>
    </div>

    <!-- ================= CENTER : NAV LINKS ================= -->
    <ul class="nav-links" [class.open]="mobileOpen">
      <li class="nav-item">
        <a routerLink="/pseudo-code" (click)="closeMobileMenu()">
          Pseudo Code
        </a>
      </li>

      <!-- ================= BEFORE LOGIN ================= -->
      <ng-container *ngIf="!(isLoggedIn$ | async)">

        <!-- ================= CATALOG ================= -->
        <li class="nav-item catalog" tabindex="0" (click)="toggleCatalog($event)" (keydown)="handleKeydown($event)">
          <span class="nav-link">
            Catalog <span class="caret">‚ñæ</span>
          </span>

          <!-- ================= CATALOG PANEL ================= -->
          <div class="catalog-panel" *ngIf="isCatalogOpen" (click)="$event.stopPropagation()">
            <div class="catalog-container">

              <!-- SIDEBAR -->
              <aside class="catalog-sidebar">
                <a *ngFor="let c of categories" [class.active]="activeCategory === c.key"
                  (click)="selectCategory(c.key)">
                  {{ c.label }}
                  <span class="underline"></span>
                </a>
              </aside>

              <!-- CONTENT -->
              <section class="catalog-content">

                <input type="text" class="catalog-search" placeholder="Search technologies..."
                  [(ngModel)]="searchText" />

                <div class="catalog-grid">
                  <a class="catalog-card" *ngFor="let item of filteredItems; let i = index" [routerLink]="item.route"
                    [class.focused]="focusedIndex === i" (mouseenter)="focusedIndex = i">
                    <img class="catalog-icon" [src]="item.icon" [alt]="item.label" />

                    <div class="card-body">
                      <h4>{{ item.label }}</h4>
                      <p>{{ item.preview }}</p>
                    </div>
                  </a>
                </div>

              </section>
            </div>
          </div>
        </li>

        <!-- ================= INTERVIEW PREP ================= -->
        <li class="nav-item" (click)="toggleOnClick('interview', $event)" [class.open]="activeDropdown === 'interview'">

          <a href="javascript:void(0)">Interview Prep</a>

          <div class="dropdown" (click)="$event.stopPropagation()">
            <div class="dropdown-section">
              <h6>Preparation</h6>
              <a routerLink="/interview-prep/java">Java Interviews</a>
              <a routerLink="/interview-prep/hr">HR Questions</a>
              <a routerLink="/interview-prep/mock">Mock Interviews</a>
            </div>
          </div>
        </li>

        <!-- ================= COURSES ================= -->
        <li class="nav-item">
          <a routerLink="/courses" (click)="closeMobileMenu()">Courses</a>
          <div class="dropdown">
            <div class="dropdown-section">
              <h6>Java Track</h6>
              <a routerLink="/courses/core-java">Core Java</a>
              <a routerLink="/courses/advanced-java">Advanced Java</a>
              <a routerLink="/courses/collections">Collections & Streams</a>
            </div>
            <div class="dropdown-section">
              <h6>Frameworks</h6>
              <a routerLink="/courses/spring">Spring</a>
              <a routerLink="/courses/spring-boot">Spring Boot</a>
            </div>
          </div>
        </li>

        <!-- ================= ROADMAPS ================= -->
        <li class="nav-item">
          <a routerLink="/roadmap" (click)="closeMobileMenu()">Roadmaps</a>
          <div class="dropdown">
            <div class="dropdown-section">
              <a routerLink="/roadmaps/java">Java Developer</a>
              <a routerLink="/roadmaps/backend">Backend Developer</a>
              <a routerLink="/roadmaps/fullstack">Full Stack</a>
            </div>
          </div>
        </li>

        <!-- ================= PRICING ================= -->
        <li class="nav-item">
          <a routerLink="/pricing" (click)="closeMobileMenu()">Pricing</a>
          <div class="dropdown">
            <div class="dropdown-section">
              <a routerLink="/pricing">Free vs PRO</a>
              <a routerLink="/pricing#pro">PRO Benefits</a>
            </div>
          </div>
        </li>

        <!-- ================= FAQ ================= -->
        <li class="nav-item">
          <a routerLink="/games" (click)="closeMobileMenu()">Games</a>
          <div class="dropdown">
          </div>
        </li>

        <!-- ================= CONTACT ================= -->
        <li class="nav-item">
          <a routerLink="/support/contact" (click)="closeMobileMenu()">Contact</a>
        </li>

      </ng-container>

      <!-- ================= AFTER LOGIN ================= -->
      <ng-container *ngIf="isLoggedIn$ | async">

        <li class="nav-item">
          <a routerLink="/dashboard/home" routerLinkActive="active" (click)="closeMobileMenu()">Dashboard</a>
        </li>

        <li class="nav-item">
          <a routerLink="/courses" (click)="closeMobileMenu()">My Courses</a>
          <div class="dropdown">
            <div class="dropdown-section">
              <a routerLink="/dashboard/home" (click)="closeMobileMenu()">Continue Learning</a>
              <a routerLink="/courses" (click)="closeMobileMenu()">All Courses</a>
            </div>
          </div>
        </li>

        <li class="nav-item">
          <a routerLink="/practice/code" (click)="closeMobileMenu()">Practice</a>
          <div class="dropdown">
            <div class="dropdown-section">
              <a routerLink="/practice/java" (click)="closeMobileMenu()">Java Problems</a>
              <a routerLink="/practice/dsa" (click)="closeMobileMenu()">DSA</a>
            </div>
          </div>
        </li>

        <li class="nav-item pro">
          <a routerLink="/pro" (click)="closeMobileMenu()">Interviews Guide</a>
          <div class="dropdown">
            <div class="dropdown-section">
              <a routerLink="/pro/interviews" (click)="closeMobileMenu()">Advanced Interviews</a>
              <a routerLink="/pro/analytics" (click)="closeMobileMenu()">Progress Analytics</a>
            </div>
          </div>
        </li>

        <li class="nav-item">
          <a routerLink="/games" (click)="closeMobileMenu()">Games</a>
          <div class="dropdown">
          </div>
        </li>
        
        <!-- ================= CART ================= -->
        <li class="nav-item cart">
          <a routerLink="/cart" class="cart-link" (click)="closeMobileMenu()">
            üõí Cart
            <span class="cart-badge" *ngIf="cartCount > 0">
              {{ cartCount }}
            </span>
          </a>
        </li>

      </ng-container>

    </ul>

    <!-- ================= RIGHT : ACTIONS ================= -->
    <div class="nav-actions">

      <ng-container *ngIf="!(isLoggedIn$ | async); else loggedIn">
        <a routerLink="/login" class="btn outline">Login</a>
        <a routerLink="/register" class="btn primary" (click)="closeMobileMenu()">Register</a>
      </ng-container>

      <ng-template #loggedIn>
        <div class="top-actions">
          <button class="icon-btn">
            üîî <span class="notify-dot"></span>
          </button>

          <button class="profile-btn" routerLink="/dashboard/profile">
            <img *ngIf="userAvatar; else initialsTpl" [src]="userAvatar" referrerpolicy="no-referrer" />
            <ng-template #initialsTpl>
              <div class="avatar-fallback">{{ initials }}</div>
            </ng-template>
            <span>{{ userName }}</span>
          </button>

          <button class="btn outline btn-primary" (click)="logout()">Logout</button>
        </div>
      </ng-template>

    </div>

  </div>
  <!-- DROPDOWN OVERLAY -->
  <div class="nav-overlay" *ngIf="activeDropdown" (click)="closeDropdown()">
  </div>

</nav>

<!-- ================= PAGE CONTENT ================= -->
<main class="page-container" [class.dashboard-layout]="isLoggedIn$ | async">

  <router-outlet></router-outlet>

</main>


<!-- =========================
     FOOTER
========================= -->
<footer class="footer">

  <!-- TOP FOOTER -->
  <div class="container footer-top">

    <!-- BRAND / ABOUT -->
    <div class="footer-col brand-col">
      <h3 class="footer-brand">Uptrix Hub</h3>
      <p class="footer-desc">
        Uptrix Hub helps developers learn, practice, and crack interviews
        at top product-based companies with structured, real-world preparation.
      </p>

      <div class="footer-social">

        <a aria-label="LinkedIn" href="https://www.linkedin.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/linkedin-svgrepo-com.svg" alt="LinkedIn" />
        </a>

        <a aria-label="GitHub" href="https://github.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/git-svgrepo-com.svg" alt="GitHub" />
        </a>

        <a aria-label="Twitter" href="https://twitter.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/twitter-color-svgrepo-com.svg" alt="Twitter" />
        </a>

        <a aria-label="YouTube" href="https://youtube.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/youtube-circle-logo-svgrepo-com.svg" alt="YouTube" />
        </a>

        <a aria-label="Instagram" href="https://instagram.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/instagram-1-svgrepo-com.svg" alt="Instagram" />
        </a>

        <a aria-label="Google Drive" href="https://drive.google.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/drive-color-svgrepo-com.svg" alt="Google Drive" />
        </a>

        <a aria-label="Dropbox" href="https://dropbox.com" target="_blank" rel="noopener">
          <img src="assets/images/icons/dropbox-color-svgrepo-com.svg" alt="Dropbox" />
        </a>

        <a aria-label="Gmail" href="mailto:support@uptrixhub.com">
          <img src="assets/images/icons/gmail-svgrepo-com.svg" alt="Gmail" />
        </a>

        <a aria-label="WhatsApp" href="https://wa.me/919010067464" target="_blank" rel="noopener">
          <img src="assets/images/icons/whatsapp-icon-logo-svgrepo-com.svg" alt="WhatsApp" />
        </a>

        <a aria-label="Telegram" href="https://t.me/uptrixhub" target="_blank" rel="noopener">
          <img src="assets/images/icons/telegram-svgrepo-com.svg" alt="Telegram" />
        </a>

      </div>

    </div>

    <!-- PRODUCTS -->
    <div class="footer-col">
      <h6>Products</h6>
      <a routerLink="/courses">Courses</a>
      <a routerLink="/practice">Practice Questions</a>
      <a routerLink="/interview-prep">Interview Prep</a>
      <a routerLink="/mock-interviews">Mock Interviews</a>
      <a routerLink="/editor">Online Code Editor</a>
    </div>

    <!-- ROADMAPS -->
    <div class="footer-col">
      <h6>Roadmaps</h6>
      <a routerLink="/roadmaps/java">Java Developer</a>
      <a routerLink="/roadmaps/backend">Backend Developer</a>
      <a routerLink="/roadmaps/fullstack">Full Stack Developer</a>
      <a routerLink="/roadmaps/devops">DevOps Engineer</a>
      <a routerLink="/roadmaps/cloud">Cloud Engineer</a>
    </div>

    <!-- COMMUNITY & SUPPORT -->
    <div class="footer-col">
      <h6>Community & Support</h6>
      <a routerLink="/support/community">Learner Community</a>
      <a routerLink="/support/help">Help & Support</a>
      <a routerLink="/support/faq">FAQs</a>
      <a routerLink="/support/contact">Contact Us</a>
      <a routerLink="/support/feedback">Feedback</a>
    </div>

    <!-- LEGAL -->
    <div class="footer-col">
      <h6>Legal & Policies</h6>
      <a routerLink="/legal/terms">Terms & Conditions</a>
      <a routerLink="/legal/privacy">Privacy Policy</a>
      <a routerLink="/legal/security">Security Policy</a>
      <a routerLink="/legal/cookies">Cookie Policy</a>
      <a routerLink="/legal/refund">Refund Policy</a>
      <a routerLink="/legal/gdpr">GDPR Compliance</a>
    </div>

  </div>

  <!-- TRUST STRIP -->
  <div class="footer-trust">
    <div class="container trust-grid">
      <span>üîí Secure Payments</span>
      <span>üìú GDPR Compliant</span>
      <span>‚≠ê 25,000+ Learners</span>
      <span>üõ°Ô∏è Data Privacy First</span>
      <span>üíº Industry-Aligned Content</span>
    </div>
  </div>

  <!-- BOTTOM FOOTER -->
  <div class="footer-bottom">
    <div class="container bottom-grid">
      <p>
        ¬© 2025 <strong>Uptrix Hub</strong>. All rights reserved.
      </p>
      <p class="muted">
        Built with ‚ù§Ô∏è for developers preparing for real interviews.
      </p>
    </div>
  </div>

</footer>