<section class="bug-hunter" *ngIf="question">

  <header class="game-header">
    <h1>ğŸ Bug Hunter Pro</h1>
    <div class="meta">
      <span>{{ currentIndex + 1 }}/{{ totalQuestions }}</span>
      <span>{{ correctCount }} Correct</span>
    </div>
  </header>

  <div class="session-bar">
    <span>ğŸ¯ Accuracy {{ accuracy }}%</span>
    <span>ğŸ§  {{ question.difficulty }}</span>
  </div>

  <div class="game-progress">
    <div class="fill" [style.width.%]="progressPercent"></div>
  </div>

  <div class="code-card">
    <pre class="code">{{ showResult ? highlightedCode : question.code }}</pre>
  </div>

  <div class="question">â“ What type of bug exists?</div>

  <button *ngIf="!showHint && !showResult" class="hint-btn" (click)="revealHint()">
    ğŸ’¡ Reveal Hint
  </button>

  <div class="hint" *ngIf="showHint">{{ hint }}</div>

  <div class="options">
    <button *ngFor="let o of options" (click)="select(o)" [disabled]="showResult"
      [class.correct]="showResult && o === question.bugType"
      [class.wrong]="showResult && selected === o && o !== question.bugType">
      {{ o }}
    </button>
  </div>

  <div class="result" *ngIf="showResult">

    <h3 [class.success]="isCorrect" [class.error]="!isCorrect">
      {{ isCorrect ? 'âœ… Correct!' : 'âŒ Wrong Answer' }}
    </h3>

    <p *ngIf="wrongExplanation">âŒ {{ wrongExplanation }}</p>

    <p><strong>âœ” Bug:</strong> {{ question.bugType }}</p>
    <p><strong>ğŸ§  Why:</strong> {{ question.reason }}</p>
    <p><strong>ğŸ›  Fix:</strong> {{ question.fix }}</p>

    <div class="ai-box" *ngIf="aiLoading">ğŸ¤– AI analyzing...</div>

    <div class="ai-box" *ngIf="aiExplanation">
      <h4>ğŸ¤– AI Explanation</h4>
      <pre>{{ aiExplanation }}</pre>

      <h4>ğŸ¯ Interview Follow-up</h4>
      <p>How would you prevent this in production?</p>
    </div>

    <button class="next-btn" (click)="next()">Next Bug â†’</button>

  </div>

</section>
<!-- ğŸ‰ CONFETTI OVERLAY -->
<!-- ğŸ‰ GLOBAL CONFETTI OVERLAY -->
<div class="confetti-overlay" *ngIf="confetti">
  <div class="confetti">ğŸ‰</div>
  <div class="confetti">ğŸŠ</div>
  <div class="confetti">âœ¨</div>
  <div class="confetti">ğŸ”¥</div>

  <div class="hurray">
    ğŸ‰ HURRAY!<br />
    Bug Fixed Successfully!
  </div>
</div>
<ng-template #loading>
  <div class="loading">â³ Loading Bug...</div>
</ng-template>